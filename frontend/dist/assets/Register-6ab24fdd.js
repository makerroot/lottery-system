import{aS as S,aR as U}from"./vendor-af4d91ab.js";import{a as w}from"./api-18050e56.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";import{a3 as F,a4 as M,e as T,a5 as q}from"./antd-icons-16470984.js";import{o as D,U as f,V as u,_ as g,Z as s,a4 as v,a0 as b,W as h,X as r,G as m,c as a,r as _,u as k}from"./vue-vendor-6562d100.js";import{m as E}from"./antd-vue-821a3ecc.js";import"./axios-78d57de0.js";import"./dayjs-793f537c.js";const G={class:"register-page"},L={class:"register-container"},P={class:"register-card glass"},W={key:0,class:"company-header"},X={class:"company-title"},Z={class:"register-tips"},j={class:"tip-text"},A={class:"tip-text"},H={key:2,class:"success-container"},J={class:"success-info"},K={key:0},Q={key:0,class:"stats-card glass"},Y={class:"stat-item"},ee={class:"stat-content"},se={class:"stat-value"},te={class:"stat-item"},ae={class:"stat-content"},oe={class:"stat-value"},le={__name:"Register",setup(ne){const I=S(),V=U(),x=_(""),d=_(null),c=_(!1),C=_(!1),l=_(""),t=_({name:"",phone:""}),z=async()=>{var p,e;try{const o=I.query.company_code;if(!o){l.value="ç¼ºå°‘å…¬å¸ä»£ç å‚æ•°";return}x.value=o;const i=await w.get(`/api/company-info?company_code=${o}`);d.value=i}catch(o){l.value=((e=(p=o.response)==null?void 0:p.data)==null?void 0:e.error)||"è·å–å…¬å¸ä¿¡æ¯å¤±è´¥"}},B=async()=>{var p,e,o,i;if(!t.value.name){l.value="è¯·è¾“å…¥å§“å";return}c.value=!0,l.value="";try{const n=await w.post("/api/self-register",{name:t.value.name,phone:t.value.phone},{params:{company_code:x.value}});C.value=!0,E.success("å‚ä¸æˆåŠŸï¼")}catch(n){((p=n.response)==null?void 0:p.status)===409?l.value=((e=n.response.data)==null?void 0:e.error)||"ç”¨æˆ·å·²å­˜åœ¨":l.value=((i=(o=n.response)==null?void 0:o.data)==null?void 0:i.error)||"æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{c.value=!1}},N=()=>{V.push(`/lottery?company=${x.value}`)};return D(()=>{z()}),(p,e)=>{const o=f("a-alert"),i=f("a-input"),n=f("a-form-item"),R=f("a-button"),O=f("a-form");return u(),g("div",G,[e[17]||(e[17]=s("div",{class:"background-effects"},[s("div",{class:"gradient-orb orb-1"}),s("div",{class:"gradient-orb orb-2"})],-1)),s("div",L,[s("div",P,[d.value?(u(),g("div",W,[s("h1",X,v(d.value.company.name),1),e[3]||(e[3]=s("p",{class:"company-subtitle"},"æ‰«ç å‚ä¸æŠ½å¥–æ´»åŠ¨",-1))])):b("",!0),C.value?(u(),g("div",H,[e[9]||(e[9]=s("div",{class:"success-icon"},"âœ…",-1)),e[10]||(e[10]=s("h2",{class:"success-title"},"å‚ä¸æˆåŠŸï¼",-1)),e[11]||(e[11]=s("p",{class:"success-message"},"æ‚¨å·²æˆåŠŸåŠ å…¥æŠ½å¥–æ± ",-1)),s("div",J,[s("p",null,[e[6]||(e[6]=s("strong",null,"å§“åï¼š",-1)),m(v(t.value.name),1)]),t.value.phone?(u(),g("p",K,[e[7]||(e[7]=s("strong",null,"æ‰‹æœºå·ï¼š",-1)),m(v(t.value.phone),1)])):b("",!0)]),a(R,{type:"primary",size:"large",onClick:N,class:"view-lottery-btn"},{default:r(()=>[...e[8]||(e[8]=[m(" æŸ¥çœ‹æŠ½å¥–é¡µé¢ ",-1)])]),_:1})])):(u(),h(O,{key:1,model:t.value,layout:"vertical",onFinish:B,class:"register-form"},{default:r(()=>[l.value?(u(),h(o,{key:0,message:l.value,type:"error","show-icon":"",closable:"",onClose:e[0]||(e[0]=y=>l.value=""),style:{"margin-bottom":"16px"}},null,8,["message"])):b("",!0),a(n,{label:"å§“å"},{default:r(()=>[a(i,{value:t.value.name,"onUpdate:value":e[1]||(e[1]=y=>t.value.name=y),placeholder:"è¯·è¾“å…¥çœŸå®å§“å",size:"large",disabled:c.value},{prefix:r(()=>[a(k(F))]),_:1},8,["value","disabled"])]),_:1}),a(n,{label:"æ‰‹æœºå·ï¼ˆé€‰å¡«ï¼‰"},{default:r(()=>[a(i,{value:t.value.phone,"onUpdate:value":e[2]||(e[2]=y=>t.value.phone=y),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·",size:"large",disabled:c.value},{prefix:r(()=>[a(k(M))]),_:1},8,["value","disabled"])]),_:1}),a(n,null,{default:r(()=>[a(R,{type:"primary","html-type":"submit",size:"large",block:"",loading:c.value,class:"register-button"},{default:r(()=>[m(v(c.value?"æ³¨å†Œä¸­...":"ğŸ‰ ç«‹å³å‚ä¸æŠ½å¥–"),1)]),_:1},8,["loading"])]),_:1}),s("div",Z,[s("p",j,[a(k(T)),e[4]||(e[4]=m(" æ³¨å†ŒæˆåŠŸåå°†è‡ªåŠ¨åŠ å…¥æŠ½å¥–æ±  ",-1))]),s("p",A,[a(k(q)),e[5]||(e[5]=m(" æ‚¨çš„ä¿¡æ¯å°†è¢«å®‰å…¨ä¿æŠ¤ ",-1))])])]),_:1},8,["model"]))]),d.value&&!C.value?(u(),g("div",Q,[s("div",Y,[e[13]||(e[13]=s("div",{class:"stat-icon"},"ğŸ‘¥",-1)),s("div",ee,[s("div",se,v(d.value.stats.total_users),1),e[12]||(e[12]=s("div",{class:"stat-label"},"å·²å‚ä¸",-1))])]),e[16]||(e[16]=s("div",{class:"stat-divider"},null,-1)),s("div",te,[e[15]||(e[15]=s("div",{class:"stat-icon"},"â³",-1)),s("div",ae,[s("div",oe,v(d.value.stats.undrawn_users),1),e[14]||(e[14]=s("div",{class:"stat-label"},"å¾…æŠ½å¥–",-1))])])])):b("",!0)])])}}},_e=$(le,[["__scopeId","data-v-ac9b1bcd"]]);export{_e as default};
