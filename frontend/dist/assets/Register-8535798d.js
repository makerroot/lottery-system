import{aT as U,aS as $}from"./vendor-a94b8c86.js";import{p as I}from"./api-b09b12eb.js";import{_ as F}from"./_plugin-vue_export-helper-c27b6911.js";import{a4 as M,a5 as q,e as A,a6 as D}from"./antd-icons-bbb5d9cb.js";import{o as E,U as d,V as r,_ as p,Z as s,c as t,a0 as f,X as n,a4 as y,W as V,G as v,r as g,u as k}from"./vue-vendor-6562d100.js";import{m as G}from"./antd-vue-e1953b5a.js";import"./axios-78d57de0.js";import"./dayjs-793f537c.js";const L={class:"register-page"},P={class:"register-container"},W={class:"register-card glass"},X={key:0,class:"loading-state"},Z={key:1,class:"error-state"},j={key:2,class:"company-header"},H={class:"company-title"},J={class:"register-tips"},K={class:"tip-text"},Q={class:"tip-text"},Y={key:4,class:"success-container"},ee={class:"success-info"},se={key:0},te={key:0,class:"stats-card glass"},ae={class:"stat-item"},oe={class:"stat-content"},le={class:"stat-value"},ne={class:"stat-item"},re={class:"stat-content"},ie={class:"stat-value"},ue={__name:"Register",setup(de){const B=U(),N=$(),x=g(""),u=g(null),c=g(!1),C=g(!1),a=g(""),o=g({name:"",phone:""}),R=async()=>{var m,e;try{const l=B.query.company_code;if(!l){a.value="ç¼ºå°‘å…¬å¸ä»£ç å‚æ•°";return}x.value=l;const i=await I.get(`/api/company-info?company_code=${l}`);u.value=i}catch(l){a.value=((e=(m=l.response)==null?void 0:m.data)==null?void 0:e.error)||"è·å–å…¬å¸ä¿¡æ¯å¤±è´¥"}},O=async()=>{var m,e,l,i;if(!o.value.name){a.value="è¯·è¾“å…¥å§“å";return}c.value=!0,a.value="";try{const _=await I.post("/api/self-register",{name:o.value.name,phone:o.value.phone},{params:{company_code:x.value}});C.value=!0,G.success("å‚ä¸æˆåŠŸï¼")}catch(_){((m=_.response)==null?void 0:m.status)===409?a.value=((e=_.response.data)==null?void 0:e.error)||"ç”¨æˆ·å·²å­˜åœ¨":a.value=((i=(l=_.response)==null?void 0:l.data)==null?void 0:i.error)||"æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"}finally{c.value=!1}},S=()=>{N.push(`/lottery?company=${x.value}`)};return E(()=>{R()}),(m,e)=>{const l=d("a-spin"),i=d("a-button"),_=d("a-result"),h=d("a-alert"),z=d("a-input"),w=d("a-form-item"),T=d("a-form");return r(),p("div",L,[e[19]||(e[19]=s("div",{class:"background-effects"},[s("div",{class:"gradient-orb orb-1"}),s("div",{class:"gradient-orb orb-2"})],-1)),s("div",P,[s("div",W,[!u.value&&!a.value?(r(),p("div",X,[t(l,{size:"large"}),e[3]||(e[3]=s("p",null,"åŠ è½½ä¸­...",-1))])):f("",!0),a.value?(r(),p("div",Z,[t(_,{status:"error",title:"åŠ è½½å¤±è´¥","sub-title":a.value},{extra:n(()=>[t(i,{type:"primary",onClick:R},{default:n(()=>[...e[4]||(e[4]=[v(" é‡è¯• ",-1)])]),_:1})]),_:1},8,["sub-title"])])):f("",!0),u.value?(r(),p("div",j,[s("h1",H,y(u.value.company.name),1),e[5]||(e[5]=s("p",{class:"company-subtitle"},"æ‰«ç å‚ä¸æŠ½å¥–æ´»åŠ¨",-1))])):f("",!0),C.value?(r(),p("div",Y,[e[11]||(e[11]=s("div",{class:"success-icon"},"âœ…",-1)),e[12]||(e[12]=s("h2",{class:"success-title"},"å‚ä¸æˆåŠŸï¼",-1)),e[13]||(e[13]=s("p",{class:"success-message"},"æ‚¨å·²æˆåŠŸåŠ å…¥æŠ½å¥–æ± ",-1)),s("div",ee,[s("p",null,[e[8]||(e[8]=s("strong",null,"å§“åï¼š",-1)),v(y(o.value.name),1)]),o.value.phone?(r(),p("p",se,[e[9]||(e[9]=s("strong",null,"æ‰‹æœºå·ï¼š",-1)),v(y(o.value.phone),1)])):f("",!0)]),t(i,{type:"primary",size:"large",onClick:S,class:"view-lottery-btn"},{default:n(()=>[...e[10]||(e[10]=[v(" æŸ¥çœ‹æŠ½å¥–é¡µé¢ ",-1)])]),_:1})])):(r(),V(T,{key:3,model:o.value,layout:"vertical",onFinish:O,class:"register-form"},{default:n(()=>[a.value?(r(),V(h,{key:0,message:a.value,type:"error","show-icon":"",closable:"",onClose:e[0]||(e[0]=b=>a.value=""),style:{"margin-bottom":"16px"}},null,8,["message"])):f("",!0),t(w,{label:"å§“å"},{default:n(()=>[t(z,{value:o.value.name,"onUpdate:value":e[1]||(e[1]=b=>o.value.name=b),placeholder:"è¯·è¾“å…¥çœŸå®å§“å",size:"large",disabled:c.value},{prefix:n(()=>[t(k(M))]),_:1},8,["value","disabled"])]),_:1}),t(w,{label:"æ‰‹æœºå·ï¼ˆé€‰å¡«ï¼‰"},{default:n(()=>[t(z,{value:o.value.phone,"onUpdate:value":e[2]||(e[2]=b=>o.value.phone=b),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·",size:"large",disabled:c.value},{prefix:n(()=>[t(k(q))]),_:1},8,["value","disabled"])]),_:1}),t(w,null,{default:n(()=>[t(i,{type:"primary","html-type":"submit",size:"large",block:"",loading:c.value,class:"register-button"},{default:n(()=>[v(y(c.value?"æ³¨å†Œä¸­...":"ğŸ‰ ç«‹å³å‚ä¸æŠ½å¥–"),1)]),_:1},8,["loading"])]),_:1}),s("div",J,[s("p",K,[t(k(A)),e[6]||(e[6]=v(" æ³¨å†ŒæˆåŠŸåå°†è‡ªåŠ¨åŠ å…¥æŠ½å¥–æ±  ",-1))]),s("p",Q,[t(k(D)),e[7]||(e[7]=v(" æ‚¨çš„ä¿¡æ¯å°†è¢«å®‰å…¨ä¿æŠ¤ ",-1))])])]),_:1},8,["model"]))]),u.value&&!C.value?(r(),p("div",te,[s("div",ae,[e[15]||(e[15]=s("div",{class:"stat-icon"},"ğŸ‘¥",-1)),s("div",oe,[s("div",le,y(u.value.stats.total_users),1),e[14]||(e[14]=s("div",{class:"stat-label"},"å·²å‚ä¸",-1))])]),e[18]||(e[18]=s("div",{class:"stat-divider"},null,-1)),s("div",ne,[e[17]||(e[17]=s("div",{class:"stat-icon"},"â³",-1)),s("div",re,[s("div",ie,y(u.value.stats.undrawn_users),1),e[16]||(e[16]=s("div",{class:"stat-label"},"å¾…æŠ½å¥–",-1))])])])):f("",!0)])])}}},be=F(ue,[["__scopeId","data-v-f84f7010"]]);export{be as default};
